<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Benchmark Results</title>
    <script>
        async function fetchResults() {
            const outputFolder = "{{ output_folder }}";
            const response = await fetch(`/api/results/${outputFolder}`);
            const data = await response.json();

            console.log("Fetched Data:", data); // Debugging

            if (Object.keys(data).length === 0) {
                document.getElementById("tables").innerHTML = "<p>No data found.</p>";
                return;
            }

            displayResults(data);
        }

        function displayResults(data) {
            const tablesDiv = document.getElementById("tables");
            tablesDiv.innerHTML = ""; // Clear previous results

            Object.keys(data).forEach((category) => {
                let table = document.createElement("table");
                table.border = "1";
                table.style.marginBottom = "20px";

                let title = document.createElement("h2");
                title.innerText = category;
                tablesDiv.appendChild(title);

                let headers = Object.keys(data[category][0] || {});

                // Create table header
                let thead = document.createElement("thead");
                let headerRow = document.createElement("tr");
                headers.forEach(header => {
                    let th = document.createElement("th");
                    th.innerText = header;
                    headerRow.appendChild(th);
                });
                thead.appendChild(headerRow);
                table.appendChild(thead);

                // Create table body
                let tbody = document.createElement("tbody");
                data[category].forEach(row => {
                    let tr = document.createElement("tr");
                    headers.forEach(header => {
                        let td = document.createElement("td");
                        td.innerText = row[header] !== null ? row[header] : "N/A";
                        tr.appendChild(td);
                    });
                    tbody.appendChild(tr);
                });
                table.appendChild(tbody);

                tablesDiv.appendChild(table);
            });
        }

        window.onload = fetchResults;
    </script>
</head>
<body>
    <h1>Benchmark Results for {{ output_folder }}</h1>
    <a href="/">Back to Selection</a>
    <div id="tables"></div>
</body>
</html>
